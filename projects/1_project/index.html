<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> GalactiTA | Jakhongir Saydaliev </title> <meta name="author" content="Jakhongir Saydaliev"> <meta name="description" content="1.3B LLM trained through a 3-stage pipeline of SFT, DPO, and RAG-tuning on scientific datasets."> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/profile.png?9eec2f327f2e2cf3da5d0adcec110cea"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://jakhongir0103.github.io/projects/1_project/"> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Jakhongir</span> Saydaliev </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/assets/pdf/cv.pdf">cv </a> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">GalactiTA</h1> <p class="post-description">1.3B LLM trained through a 3-stage pipeline of SFT, DPO, and RAG-tuning on scientific datasets.</p> </header> <article> <div class="links" style="margin-bottom: 2rem;"> <a href="https://github.com/Jakhongir0103/sft-dpo-rag-training/blob/main/pdfs/report.pdf" class="btn btn-primary btn-sm" role="button" target="_blank" style="background-color: white !important; border: 1px solid black !important; color: black !important; padding: 8px 16px; border-radius: 4px; text-decoration: none; display: inline-block; margin-right: 10px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);" rel="external nofollow noopener"> <i class="fas fa-file-pdf"></i> Technical Report </a> </div> <p>Large Language Models have transformed education, but they often struggle with technical domains and complex reasoning. This project addresses a key question: <strong>How can we adapt pre-trained LLMs for scientific multiple-choice question answering?</strong></p> <p>We developed <strong>GalactiTA</strong>, a digital teaching assistant specifically designed for STEM subjects. Starting with the Galactica-1.3B model, we applied a three-stage training pipeline: Supervised Fine-Tuning (SFT), Direct Preference Optimization (DPO$^{[1]}$), and Retrieval-Augmented Generation (RAG$^{[2]}$) tuning. The final model achieved an <strong>11.52% improvement</strong> over the baseline on EPFL course questions, demonstrating that smaller, specialized models can effectively support students and teaching assistants with domain-specific queries.</p> <h2 id="methodology">Methodology</h2> <p>Our approach follows a systematic pipeline with three distinct training phases. The overall workflow is illustrated below:</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/projects/mnlp_overall_workflow-480.webp 480w,/assets/img/projects/mnlp_overall_workflow-800.webp 800w,/assets/img/projects/mnlp_overall_workflow-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/projects/mnlp_overall_workflow.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Training pipeline workflow" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> The complete training pipeline: SFT for question answering, DPO for preference alignment, and RAG-tuning for incorporating external knowledge. </div> <p><strong>Supervised Fine-Tuning (SFT)</strong><br> We trained <a href="https://huggingface.co/facebook/galactica-1.3b" rel="external nofollow noopener" target="_blank">Galactica-1.3B</a> on scientific QA datasets (<a href="https://scienceqa.github.io/" rel="external nofollow noopener" target="_blank">ScienceQA</a>, <a href="https://huggingface.co/datasets/allenai/sciq" rel="external nofollow noopener" target="_blank">SciQ</a>, <a href="https://huggingface.co/datasets/allenai/ai2_arc" rel="external nofollow noopener" target="_blank">ARC</a>, <a href="https://huggingface.co/datasets/HuggingFaceH4/stack-exchange-preferences" rel="external nofollow noopener" target="_blank">Stack Exchange</a>) totaling ~43k questions. For datasets lacking explanations, we used ChatGPT to generate Chain-of-Thought (CoT) reasoning, teaching the model to explain its answers rather than just provide them.</p> <p><strong>Direct Preference Optimization (DPO)</strong><br> Rather than traditional reinforcement learning, we used DPO$^{[1]}$ to align the model with human preferences. The data collection process involved prompting ChatGPT strategically to generate high-quality responses:</p> <div class="row justify-content-sm-center"> <div class="col-sm-6 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/projects/mnlp_dpo_dataset-480.webp 480w,/assets/img/projects/mnlp_dpo_dataset-800.webp 800w,/assets/img/projects/mnlp_dpo_dataset-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/projects/mnlp_dpo_dataset.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="DPO data collection" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Interaction with ChatGPT to collect preference data, using prompts like "Let's think step by step" to generate high-quality responses. </div> <p>We collected pairs of “good” and “bad” responses—both AI-generated from ChatGPT and human-annotated from platforms like Stack Exchange. This taught the model to distinguish between high-quality and low-quality scientific explanations.</p> <p><strong>RAG-Tuning</strong><br> In the final phase, we fine-tuned the model for RAG$^{[2]}$ incorporating external knowledge. We collected 5GB of scientific documents (textbooks, papers) and created training data where the model learned to generate answers based on retrieved context:</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/projects/mnlp_raft_workflow-480.webp 480w,/assets/img/projects/mnlp_raft_workflow-800.webp 800w,/assets/img/projects/mnlp_raft_workflow-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/projects/mnlp_raft_workflow.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="RAG-tuning workflow" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> High-level workflow of the RAG-tuning phase: documents are chunked, embedded, and retrieved based on question similarity, then used to train the model to reason from external sources. </div> <p>For each question, we retrieved the top-3 relevant documents and trained the model to reason from these sources. This approach allows the model to leverage domain-specific knowledge beyond its training data.</p> <h2 id="evaluation-methods">Evaluation Methods</h2> <p>We designed three automatic evaluation methods to assess model performance on multiple-choice questions:</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/projects/mnlp_all_eval_methods-480.webp 480w,/assets/img/projects/mnlp_all_eval_methods-800.webp 800w,/assets/img/projects/mnlp_all_eval_methods-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/projects/mnlp_all_eval_methods.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Three evaluation methods" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Three decoding strategies: (1) Token Distribution - examining probabilities for A/B/C/D directly, (2) Greedy Decoding - predicting from entire vocabulary, and (3) Option Probability Sum - calculating cumulative probability for each complete option. </div> <p>These complementary methods allow us to assess whether the model truly learned to answer multiple-choice questions correctly or is simply exploiting patterns in the data.</p> <h2 id="results">Results</h2> <p>Our experiments revealed several key findings across four test datasets (ARC, MMLU, SciQ, EPFL). The table below shows accuracy scores using Method 1 (Token Distribution):</p> <div style="text-align: center;"> | Model | ARC | MMLU | SciQ | EPFL | |-------|-----|------|------|------| | GalactiTA (DPO only) | 29.24% | 29.03% | 41.31% | 27.32% | | GalactiTA (MCQA-tuned) | **35.06%** | 31.61% | **60.50%** | 35.59% | | GalactiTA (MCQA + RAG) | 33.00% | **32.90%** | 53.22% | 34.59% | | GalactiTA (RAG-tuned) | 31.01% | 29.68% | 47.35% | 30.83% | | GalactiTA (RAG + RAG) | 29.67% | 30.97% | 45.47% | 31.58% | | TinyLlama | 24.34% | 25.16% | 24.00% | 36.84% | | TinyLlama (+ RAG) | 25.20% | 22.58% | 25.80% | **38.60%** | </div> <p><strong>MCQA-tuning was highly effective</strong>: The model learned to predict single letters accurately, with Method 1 and Method 2 scores matching perfectly after MCQA-tuning. This demonstrates that the model genuinely learned the task structure rather than exploiting shortcuts.</p> <p><strong>RAG benefits were dataset-dependent</strong>: For EPFL questions specifically, RAG-tuning with retrieval showed an 11.52% improvement over the baseline when comparing greedy decoding methods. This makes sense because our document collection was curated for EPFL-relevant topics. On datasets where retrieved documents were less relevant (like general science benchmarks), adding RAG during inference sometimes confused the model rather than helping it.</p> <p>Our ablation studies revealed important insights about training dynamics:</p> <div class="row justify-content-sm-center"> <div class="col-sm-6 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/projects/mnlp_epochs-480.webp 480w,/assets/img/projects/mnlp_epochs-800.webp 800w,/assets/img/projects/mnlp_epochs-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/projects/mnlp_epochs.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Effect of training epochs" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Training with more epochs doesn't always help: the best performance came from 1 epoch of SFT followed by 1 epoch of DPO. Over-training the SFT model actually degraded DPO performance. </div> <p>We found that using 3-4 retrieved documents was optimal, and that training with only one epoch each for SFT and DPO produced the best results. Training longer actually degraded DPO performance, suggesting the importance of careful hyperparameter tuning in alignment tasks.</p> <p><strong>Scalability confirmed</strong>: Testing on Llama-3 8B showed our RAG-tuning approach generalizes to larger models, with the RAG-tuned version achieving 62.38% on ARC when using retrieval (vs. 33.07% without), validating our training methodology across different model scales.</p> <h2 id="references">References</h2> <ol> <li> <p><strong>Direct Preference Optimization</strong>: Rafailov, R., Sharma, A., Mitchell, E., Ermon, S., Manning, C. D., &amp; Finn, C. (2024). Direct Preference Optimization: Your Language Model is Secretly a Reward Model. <em>arXiv preprint arXiv:2305.18290</em>. <a href="https://arxiv.org/abs/2305.18290" rel="external nofollow noopener" target="_blank">https://arxiv.org/abs/2305.18290</a></p> </li> <li> <p><strong>Retrieval-Augmented Generation</strong>: Lewis, P., Perez, E., Piktus, A., Petroni, F., Karpukhin, V., Goyal, N., Küttler, H., Lewis, M., Yih, W., Rocktäschel, T., Riedel, S., &amp; Kiela, D. (2021). Retrieval-Augmented Generation for Knowledge-Intensive NLP Tasks. <em>arXiv preprint arXiv:2005.11401</em>. <a href="https://arxiv.org/abs/2005.11401" rel="external nofollow noopener" target="_blank">https://arxiv.org/abs/2005.11401</a></p> </li> </ol> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Jakhongir Saydaliev. Last updated: October 09, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> </body> </html>